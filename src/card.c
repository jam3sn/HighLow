#define CARD_HEIGHT 5
#define CARD_WIDTH 3

const unsigned char card_tile_map[] = {
    0x00, 0x00, 0x3F, 0x3F, 0x7F, 0x40, 0xFF, 0x80, 0xFF, 0x88, 0xFF, 0x9C, 0xFF, 0x88, 0xFF, 0x80,
    0x00, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0xFF, 0x00,
    0x00, 0x00, 0xFC, 0xFC, 0xFF, 0x03, 0xFF, 0x01, 0xFF, 0x11, 0xFF, 0x39, 0xFF, 0x11, 0xFF, 0x01,
    0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88,
    0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0x81, 0x7E, 0xDB, 0x24, 0xC3, 0x3C, 0xDB, 0x24,
    0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11,
    0x81, 0x7E, 0xFF, 0x00, 0xFF, 0x00, 0xE7, 0x18, 0xE7, 0x18, 0xFF, 0x00, 0xFF, 0x00, 0xC7, 0x38,
    0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xFF, 0x80,
    0xEF, 0x10, 0xEF, 0x10, 0xEF, 0x10, 0xC3, 0x3C, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00,
    0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xFF, 0x01,
    0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88, 0xFF, 0x80, 0xFF, 0x80, 0xFC, 0x83, 0xF8, 0x87, 0xF8, 0x87,
    0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xC3, 0x3C, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF,
    0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11, 0xFF, 0x01, 0xFF, 0x01, 0x3F, 0xC1, 0x1F, 0xE1, 0x1F, 0xE1,
    0xF0, 0x8F, 0xF0, 0x8F, 0xE0, 0x9F, 0xE0, 0x9F, 0xE0, 0x9F, 0xE0, 0x9F, 0xF0, 0x8F, 0xF0, 0x8F,
    0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF,
    0x0F, 0xF1, 0x0F, 0xF1, 0x07, 0xF9, 0x07, 0xF9, 0x07, 0xF9, 0x07, 0xF9, 0x0F, 0xF1, 0x0F, 0xF1,
    0xF8, 0x87, 0xF8, 0x87, 0xFC, 0x83, 0xFF, 0x80, 0xFF, 0x80, 0xF7, 0x88, 0xF7, 0x88, 0xF7, 0x88,
    0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0xC3, 0x3C, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00,
    0x1F, 0xE1, 0x1F, 0xE1, 0x3F, 0xC1, 0xFF, 0x01, 0xFF, 0x01, 0xEF, 0x11, 0xEF, 0x11, 0xEF, 0x11,
    0xFF, 0x80, 0xFF, 0x88, 0xFF, 0x9C, 0xFF, 0x88, 0xFF, 0x80, 0x7F, 0x40, 0x3F, 0x3F, 0x00, 0x00,
    0xFF, 0x00, 0xFF, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0xFF, 0x00, 0x00,
    0xFF, 0x01, 0xFF, 0x11, 0xFF, 0x39, 0xFF, 0x11, 0xFF, 0x01, 0xFE, 0x02, 0xFC, 0xFC, 0x00, 0x00};

const uint8_t card_sprite_matrix[2][CARD_HEIGHT][CARD_WIDTH] = {
    {
        // Front sprite layout
        {0, 1, 2},
        {10, 11, 12},
        {13, 14, 15},
        {16, 17, 18},
        {19, 20, 21},
    },
    {
        // Back sprite layout
        {0, 1, 2},
        {3, 4, 5},
        {3, 6, 5},
        {3, 8, 5},
        {19, 20, 21},
    },
};

enum side
{
    FRONT,
    BACK
};

typedef struct card
{
    // in tiles
    uint8_t sprites[CARD_HEIGHT][CARD_WIDTH];
    uint8_t x;
    uint8_t y;
    uint8_t number;
    enum side side;
} card;

void load_card_data()
{
    set_sprite_data(0, 22, card_tile_map);
}

// Loop through the card, line by line, loading the the sprite no from card_sprite_matrix
void load_card_sprites(uint8_t tile_start, card *card)
{
    uint8_t iteration = 0;

    for (uint8_t row = 0; row < CARD_HEIGHT; row++)
    {
        for (uint8_t col = 0; col < CARD_WIDTH; col++)
        {
            card->sprites[row][col] = tile_start + iteration;
            set_sprite_tile(card->sprites[row][col], card_sprite_matrix[card->side][row][col]);
            iteration++;
        }
    }
}

void move_card(card card)
{
    for (uint8_t row = 0; row < CARD_HEIGHT; row++)
    {
        for (uint8_t col = 0; col < CARD_WIDTH; col++)
        {
            move_sprite(card.sprites[row][col], card.x + (col * 8), card.y + (row * 8));
        }
    }
}

void clear_cards()
{
    for (uint8_t i = 0; 1 < 2; i++)
        hide_sprite(i);
}